<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="æœ€å¤§ä¼¼ç„¶æ¡†æ¶ä¸‹ï¼Œå‡è®¾è§‚æµ‹å˜é‡æœ‰ç¼ºå¤±æˆ–ä¸å¯è§‚æµ‹çš„å±æ€§æ—¶ï¼Œè¦ç”¨åˆ°å˜åˆ†çš„æ–¹æ³•ã€‚éšå˜é‡æ¨¡å‹å¾€å¾€æ˜¯æ— ç›‘ç£æˆ–è€…å°‘ç›‘ç£æ¨¡å‹ï¼Œå› ä¸ºç›‘ç£ä¿¡æ¯å¯ä»¥çœ‹åšæ˜¯åŒ…å«åœ¨ç¼ºå¤±çš„éšå˜é‡ä¸­çš„ä¸€éƒ¨åˆ†ã€‚\næ³¨æ„ï¼š\nç¼ºå¤±è§‚æµ‹å’Œæ ·æœ¬ä¸€ä¸€å¯¹åº”ï¼Œè€Œå‚æ•°åˆ™æ˜¯æ‰€æœ‰æ ·æœ¬å…±äº«çš„ã€‚ ä¼¼ç„¶ä¸‹ç•Œçš„è¾“å…¥æ˜¯å‚æ•°å’Œå˜åˆ†åˆ†å¸ƒï¼Œæ¢¯åº¦å›å¸¦åˆ°å‚æ•°å’Œåˆ†å¸ƒä¸Šã€‚ ä¸å¯å¤„ç†ï¼ˆintractableï¼‰çš„åˆ†å¸ƒå®šä¹‰ä¸ºæ— æ³•è®¡ç®—ï¼Œä¸”æ— æ³•æ±‚å¯¼ã€‚ å‡è®¾è¾“å…¥$(x, z)\\in\\mathcal{D}=\\mathcal{X}\\times\\mathcal{Z}$ä¸­$\\mathcal{Z}$ç©ºé—´æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±å˜ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°è¾¹ç¼˜ä¼¼ç„¶\n$$ \\tag{1} \\max_{\\theta\\in\\Theta}\\log\\mathcal{L}(\\theta;\\mathbf{X})=\\sum_{x\\in\\mathbf{X}}\\log p_\\theta(x)=\\sum_{x\\in\\mathbf{X}}\\log\\sum_{z\\in\\mathcal{Z}}p_{\\theta}(x, z), $$å…¶ä¸­$\\mathbf{X}\\subset\\mathcal{X}$æ˜¯è§‚æµ‹åˆ°çš„æ•°æ®é›†ã€‚\nEMç®—æ³• ç›´æ¥åœ¨å¼å­$(1)$ä¸­å¯¹$\\theta$æ±‚å¯¼æ˜¯ä¸å¥½è®¡ç®—çš„ï¼Œå› ä¸º$\\log$ä¸­æœ‰æ±‚å’Œã€‚EMç®—æ³•çš„æ€è·¯æ˜¯ä¼˜åŒ–$(1)$çš„ä¸‹ç•Œï¼Œå…¶æ ¸å¿ƒå‡è®¾æ˜¯$p_\\theta(x, z)$æ˜¯å¾ˆå¥½å¤„ç†çš„ã€‚åˆ©ç”¨$\\log$å‡½æ•°çš„å‡¹æ€§å’ŒJensenä¸ç­‰å¼ï¼š\n$$ \\tag{2} \\log\\sum_{z\\in\\mathcal{Z}}p_{\\theta}(x, z) = \\log\\sum_{z\\in\\mathcal{Z}}\\frac{p_{\\theta}(x, z)}{q(z)}q(z) \\geq \\sum_{z\\in\\mathcal{Z}}q(z)\\left\\{\\log p_\\theta(x, z)-\\log q(z)\\right\\}, $$å…¶ä¸­$q(z)$æ˜¯ä»»æ„å®šä¹‰åœ¨$\\mathcal{Z}$ä¸Šçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¸”$\\forall z \\in \\mathcal{Z} q(z) > 0$ã€‚å› æ­¤ä¹‹åä¼˜åŒ–ä¸‹ç•Œ\n$$ \\max_\\theta\\hat{\\mathcal{L}}(q, \\theta;\\mathbf{X})=\\sum_{x\\in\\mathcal{X}}\\sum_{z\\in\\mathcal{Z}}q(z)\\left\\{\\log p_\\theta(x, z)-\\log q(z)\\right\\}. $$è¿™ä¸ªä¸‹ç•Œæ˜¯ä¸€ä¸ªåŒå˜é‡çš„æ³›å‡½ï¼Œä¸€ä¸ªå˜é‡æ˜¯æ¦‚ç‡å¯†åº¦$q$ï¼Œä¸€ä¸ªå˜é‡æ˜¯å‚æ•°$\\theta$ã€‚é‡‡ç”¨åæ ‡æ¢¯åº¦æ³•ï¼Œäº¤æ›¿å¯»æ‰¾å½“å‰æœ€ä¼˜çš„$q$å’Œ$\\theta$å³ä¸ºEMç®—æ³•ã€‚å¯¹$q$å–æœ€å¤§è¦æ±‚$(2)$å¼ä¸­ç­‰å·æˆç«‹ï¼Œå³è¦æ±‚$\\forall z \\in \\mathcal{Z}, p_\\theta(x, z)/q(z)=C$ï¼Œ$C$ä¸ºæŸä¸€å¸¸æ•°ï¼Œç®€å•è®¡ç®—ä¸€ä¸‹èƒ½å¾—åˆ°$C = p_\\theta(x)$ï¼Œè€Œ\n$$ \\tag{E step} q^\\star(z)=p_{\\theta}(z|x) $$è€Œæˆ‘ä»¬åœ¨Mæ­¥æ—¶å¾€å¾€ä¼šé‡åˆ°$\\sum_zq(z)\\cdot z$è¿™æ ·çš„$z$çš„æœŸæœ›å½¢å¼ï¼Œå› æ­¤åœ¨å®é™…å®ç°ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€åœ¨å†…å­˜é‡Œè®°å½•éšå˜é‡çš„æœŸæœ›\n$$ \\tag{E step in practice} \\mathbb{E}[z] = \\sum_{z\\in\\mathcal{Z}}p_\\theta(z|x)\\cdot z $$è¿™ä¹Ÿæ˜¯Eæ­¥åå­—çš„ç”±æ¥ã€‚Mæ­¥å¾—ååŸå› æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸€æ­¥é‡Œå¯¹$\\theta$æ±‚äº†æœ€å¤§ï¼Œæ³¨æ„è¿™ä¸ªä¸‹ç•Œå¾€å¾€æ˜¯å‡¹çš„ï¼ˆå¤§éƒ¨åˆ†æ¨¡å‹æ˜¯å¯¹æ•°å‡¹çš„ï¼Œæ¯”å¦‚GMMä¸­çš„é«˜æ–¯åˆ†å¸ƒç­‰æŒ‡æ•°æ—åˆ†å¸ƒï¼‰ï¼Œå› æ­¤æ›´æ–°çš„æ–¹å¼ä¸º\n$$ \\tag{M step} \\theta^{new} = \\arg\\max_\\theta\\sum_{z\\in\\mathcal{Z}}p_{\\theta^{old}}(z|x)\\log p_\\theta(x, z) $$è¡¨ç¤ºæˆæ¦‚ç‡å›¾æ˜¯è¿™æ ·ï¼š\n"><title>éšå˜é‡æ¨¡å‹æ€»ç»“</title>
<link rel=canonical href=https://fingertap.github.io/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="éšå˜é‡æ¨¡å‹æ€»ç»“"><meta property='og:description' content="æœ€å¤§ä¼¼ç„¶æ¡†æ¶ä¸‹ï¼Œå‡è®¾è§‚æµ‹å˜é‡æœ‰ç¼ºå¤±æˆ–ä¸å¯è§‚æµ‹çš„å±æ€§æ—¶ï¼Œè¦ç”¨åˆ°å˜åˆ†çš„æ–¹æ³•ã€‚éšå˜é‡æ¨¡å‹å¾€å¾€æ˜¯æ— ç›‘ç£æˆ–è€…å°‘ç›‘ç£æ¨¡å‹ï¼Œå› ä¸ºç›‘ç£ä¿¡æ¯å¯ä»¥çœ‹åšæ˜¯åŒ…å«åœ¨ç¼ºå¤±çš„éšå˜é‡ä¸­çš„ä¸€éƒ¨åˆ†ã€‚\næ³¨æ„ï¼š\nç¼ºå¤±è§‚æµ‹å’Œæ ·æœ¬ä¸€ä¸€å¯¹åº”ï¼Œè€Œå‚æ•°åˆ™æ˜¯æ‰€æœ‰æ ·æœ¬å…±äº«çš„ã€‚ ä¼¼ç„¶ä¸‹ç•Œçš„è¾“å…¥æ˜¯å‚æ•°å’Œå˜åˆ†åˆ†å¸ƒï¼Œæ¢¯åº¦å›å¸¦åˆ°å‚æ•°å’Œåˆ†å¸ƒä¸Šã€‚ ä¸å¯å¤„ç†ï¼ˆintractableï¼‰çš„åˆ†å¸ƒå®šä¹‰ä¸ºæ— æ³•è®¡ç®—ï¼Œä¸”æ— æ³•æ±‚å¯¼ã€‚ å‡è®¾è¾“å…¥$(x, z)\\in\\mathcal{D}=\\mathcal{X}\\times\\mathcal{Z}$ä¸­$\\mathcal{Z}$ç©ºé—´æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±å˜ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°è¾¹ç¼˜ä¼¼ç„¶\n$$ \\tag{1} \\max_{\\theta\\in\\Theta}\\log\\mathcal{L}(\\theta;\\mathbf{X})=\\sum_{x\\in\\mathbf{X}}\\log p_\\theta(x)=\\sum_{x\\in\\mathbf{X}}\\log\\sum_{z\\in\\mathcal{Z}}p_{\\theta}(x, z), $$å…¶ä¸­$\\mathbf{X}\\subset\\mathcal{X}$æ˜¯è§‚æµ‹åˆ°çš„æ•°æ®é›†ã€‚\nEMç®—æ³• ç›´æ¥åœ¨å¼å­$(1)$ä¸­å¯¹$\\theta$æ±‚å¯¼æ˜¯ä¸å¥½è®¡ç®—çš„ï¼Œå› ä¸º$\\log$ä¸­æœ‰æ±‚å’Œã€‚EMç®—æ³•çš„æ€è·¯æ˜¯ä¼˜åŒ–$(1)$çš„ä¸‹ç•Œï¼Œå…¶æ ¸å¿ƒå‡è®¾æ˜¯$p_\\theta(x, z)$æ˜¯å¾ˆå¥½å¤„ç†çš„ã€‚åˆ©ç”¨$\\log$å‡½æ•°çš„å‡¹æ€§å’ŒJensenä¸ç­‰å¼ï¼š\n$$ \\tag{2} \\log\\sum_{z\\in\\mathcal{Z}}p_{\\theta}(x, z) = \\log\\sum_{z\\in\\mathcal{Z}}\\frac{p_{\\theta}(x, z)}{q(z)}q(z) \\geq \\sum_{z\\in\\mathcal{Z}}q(z)\\left\\{\\log p_\\theta(x, z)-\\log q(z)\\right\\}, $$å…¶ä¸­$q(z)$æ˜¯ä»»æ„å®šä¹‰åœ¨$\\mathcal{Z}$ä¸Šçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¸”$\\forall z \\in \\mathcal{Z} q(z) > 0$ã€‚å› æ­¤ä¹‹åä¼˜åŒ–ä¸‹ç•Œ\n$$ \\max_\\theta\\hat{\\mathcal{L}}(q, \\theta;\\mathbf{X})=\\sum_{x\\in\\mathcal{X}}\\sum_{z\\in\\mathcal{Z}}q(z)\\left\\{\\log p_\\theta(x, z)-\\log q(z)\\right\\}. $$è¿™ä¸ªä¸‹ç•Œæ˜¯ä¸€ä¸ªåŒå˜é‡çš„æ³›å‡½ï¼Œä¸€ä¸ªå˜é‡æ˜¯æ¦‚ç‡å¯†åº¦$q$ï¼Œä¸€ä¸ªå˜é‡æ˜¯å‚æ•°$\\theta$ã€‚é‡‡ç”¨åæ ‡æ¢¯åº¦æ³•ï¼Œäº¤æ›¿å¯»æ‰¾å½“å‰æœ€ä¼˜çš„$q$å’Œ$\\theta$å³ä¸ºEMç®—æ³•ã€‚å¯¹$q$å–æœ€å¤§è¦æ±‚$(2)$å¼ä¸­ç­‰å·æˆç«‹ï¼Œå³è¦æ±‚$\\forall z \\in \\mathcal{Z}, p_\\theta(x, z)/q(z)=C$ï¼Œ$C$ä¸ºæŸä¸€å¸¸æ•°ï¼Œç®€å•è®¡ç®—ä¸€ä¸‹èƒ½å¾—åˆ°$C = p_\\theta(x)$ï¼Œè€Œ\n$$ \\tag{E step} q^\\star(z)=p_{\\theta}(z|x) $$è€Œæˆ‘ä»¬åœ¨Mæ­¥æ—¶å¾€å¾€ä¼šé‡åˆ°$\\sum_zq(z)\\cdot z$è¿™æ ·çš„$z$çš„æœŸæœ›å½¢å¼ï¼Œå› æ­¤åœ¨å®é™…å®ç°ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€åœ¨å†…å­˜é‡Œè®°å½•éšå˜é‡çš„æœŸæœ›\n$$ \\tag{E step in practice} \\mathbb{E}[z] = \\sum_{z\\in\\mathcal{Z}}p_\\theta(z|x)\\cdot z $$è¿™ä¹Ÿæ˜¯Eæ­¥åå­—çš„ç”±æ¥ã€‚Mæ­¥å¾—ååŸå› æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸€æ­¥é‡Œå¯¹$\\theta$æ±‚äº†æœ€å¤§ï¼Œæ³¨æ„è¿™ä¸ªä¸‹ç•Œå¾€å¾€æ˜¯å‡¹çš„ï¼ˆå¤§éƒ¨åˆ†æ¨¡å‹æ˜¯å¯¹æ•°å‡¹çš„ï¼Œæ¯”å¦‚GMMä¸­çš„é«˜æ–¯åˆ†å¸ƒç­‰æŒ‡æ•°æ—åˆ†å¸ƒï¼‰ï¼Œå› æ­¤æ›´æ–°çš„æ–¹å¼ä¸º\n$$ \\tag{M step} \\theta^{new} = \\arg\\max_\\theta\\sum_{z\\in\\mathcal{Z}}p_{\\theta^{old}}(z|x)\\log p_\\theta(x, z) $$è¡¨ç¤ºæˆæ¦‚ç‡å›¾æ˜¯è¿™æ ·ï¼š\n"><meta property='og:url' content='https://fingertap.github.io/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/'><meta property='og:site_name' content='å¼ æ™—çš„éšç¬”'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Machine Learning'><meta property='article:tag' content='Bayesian'><meta property='article:tag' content='Math'><meta property='article:published_time' content='2019-07-01T00:02:20+08:00'><meta property='article:modified_time' content='2019-07-01T00:02:20+08:00'><meta property='og:image' content='https://fingertap.github.io/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/cover.png'><meta name=twitter:title content="éšå˜é‡æ¨¡å‹æ€»ç»“"><meta name=twitter:description content="æœ€å¤§ä¼¼ç„¶æ¡†æ¶ä¸‹ï¼Œå‡è®¾è§‚æµ‹å˜é‡æœ‰ç¼ºå¤±æˆ–ä¸å¯è§‚æµ‹çš„å±æ€§æ—¶ï¼Œè¦ç”¨åˆ°å˜åˆ†çš„æ–¹æ³•ã€‚éšå˜é‡æ¨¡å‹å¾€å¾€æ˜¯æ— ç›‘ç£æˆ–è€…å°‘ç›‘ç£æ¨¡å‹ï¼Œå› ä¸ºç›‘ç£ä¿¡æ¯å¯ä»¥çœ‹åšæ˜¯åŒ…å«åœ¨ç¼ºå¤±çš„éšå˜é‡ä¸­çš„ä¸€éƒ¨åˆ†ã€‚\næ³¨æ„ï¼š\nç¼ºå¤±è§‚æµ‹å’Œæ ·æœ¬ä¸€ä¸€å¯¹åº”ï¼Œè€Œå‚æ•°åˆ™æ˜¯æ‰€æœ‰æ ·æœ¬å…±äº«çš„ã€‚ ä¼¼ç„¶ä¸‹ç•Œçš„è¾“å…¥æ˜¯å‚æ•°å’Œå˜åˆ†åˆ†å¸ƒï¼Œæ¢¯åº¦å›å¸¦åˆ°å‚æ•°å’Œåˆ†å¸ƒä¸Šã€‚ ä¸å¯å¤„ç†ï¼ˆintractableï¼‰çš„åˆ†å¸ƒå®šä¹‰ä¸ºæ— æ³•è®¡ç®—ï¼Œä¸”æ— æ³•æ±‚å¯¼ã€‚ å‡è®¾è¾“å…¥$(x, z)\\in\\mathcal{D}=\\mathcal{X}\\times\\mathcal{Z}$ä¸­$\\mathcal{Z}$ç©ºé—´æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±å˜ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°è¾¹ç¼˜ä¼¼ç„¶\n$$ \\tag{1} \\max_{\\theta\\in\\Theta}\\log\\mathcal{L}(\\theta;\\mathbf{X})=\\sum_{x\\in\\mathbf{X}}\\log p_\\theta(x)=\\sum_{x\\in\\mathbf{X}}\\log\\sum_{z\\in\\mathcal{Z}}p_{\\theta}(x, z), $$å…¶ä¸­$\\mathbf{X}\\subset\\mathcal{X}$æ˜¯è§‚æµ‹åˆ°çš„æ•°æ®é›†ã€‚\nEMç®—æ³• ç›´æ¥åœ¨å¼å­$(1)$ä¸­å¯¹$\\theta$æ±‚å¯¼æ˜¯ä¸å¥½è®¡ç®—çš„ï¼Œå› ä¸º$\\log$ä¸­æœ‰æ±‚å’Œã€‚EMç®—æ³•çš„æ€è·¯æ˜¯ä¼˜åŒ–$(1)$çš„ä¸‹ç•Œï¼Œå…¶æ ¸å¿ƒå‡è®¾æ˜¯$p_\\theta(x, z)$æ˜¯å¾ˆå¥½å¤„ç†çš„ã€‚åˆ©ç”¨$\\log$å‡½æ•°çš„å‡¹æ€§å’ŒJensenä¸ç­‰å¼ï¼š\n$$ \\tag{2} \\log\\sum_{z\\in\\mathcal{Z}}p_{\\theta}(x, z) = \\log\\sum_{z\\in\\mathcal{Z}}\\frac{p_{\\theta}(x, z)}{q(z)}q(z) \\geq \\sum_{z\\in\\mathcal{Z}}q(z)\\left\\{\\log p_\\theta(x, z)-\\log q(z)\\right\\}, $$å…¶ä¸­$q(z)$æ˜¯ä»»æ„å®šä¹‰åœ¨$\\mathcal{Z}$ä¸Šçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¸”$\\forall z \\in \\mathcal{Z} q(z) > 0$ã€‚å› æ­¤ä¹‹åä¼˜åŒ–ä¸‹ç•Œ\n$$ \\max_\\theta\\hat{\\mathcal{L}}(q, \\theta;\\mathbf{X})=\\sum_{x\\in\\mathcal{X}}\\sum_{z\\in\\mathcal{Z}}q(z)\\left\\{\\log p_\\theta(x, z)-\\log q(z)\\right\\}. $$è¿™ä¸ªä¸‹ç•Œæ˜¯ä¸€ä¸ªåŒå˜é‡çš„æ³›å‡½ï¼Œä¸€ä¸ªå˜é‡æ˜¯æ¦‚ç‡å¯†åº¦$q$ï¼Œä¸€ä¸ªå˜é‡æ˜¯å‚æ•°$\\theta$ã€‚é‡‡ç”¨åæ ‡æ¢¯åº¦æ³•ï¼Œäº¤æ›¿å¯»æ‰¾å½“å‰æœ€ä¼˜çš„$q$å’Œ$\\theta$å³ä¸ºEMç®—æ³•ã€‚å¯¹$q$å–æœ€å¤§è¦æ±‚$(2)$å¼ä¸­ç­‰å·æˆç«‹ï¼Œå³è¦æ±‚$\\forall z \\in \\mathcal{Z}, p_\\theta(x, z)/q(z)=C$ï¼Œ$C$ä¸ºæŸä¸€å¸¸æ•°ï¼Œç®€å•è®¡ç®—ä¸€ä¸‹èƒ½å¾—åˆ°$C = p_\\theta(x)$ï¼Œè€Œ\n$$ \\tag{E step} q^\\star(z)=p_{\\theta}(z|x) $$è€Œæˆ‘ä»¬åœ¨Mæ­¥æ—¶å¾€å¾€ä¼šé‡åˆ°$\\sum_zq(z)\\cdot z$è¿™æ ·çš„$z$çš„æœŸæœ›å½¢å¼ï¼Œå› æ­¤åœ¨å®é™…å®ç°ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€åœ¨å†…å­˜é‡Œè®°å½•éšå˜é‡çš„æœŸæœ›\n$$ \\tag{E step in practice} \\mathbb{E}[z] = \\sum_{z\\in\\mathcal{Z}}p_\\theta(z|x)\\cdot z $$è¿™ä¹Ÿæ˜¯Eæ­¥åå­—çš„ç”±æ¥ã€‚Mæ­¥å¾—ååŸå› æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸€æ­¥é‡Œå¯¹$\\theta$æ±‚äº†æœ€å¤§ï¼Œæ³¨æ„è¿™ä¸ªä¸‹ç•Œå¾€å¾€æ˜¯å‡¹çš„ï¼ˆå¤§éƒ¨åˆ†æ¨¡å‹æ˜¯å¯¹æ•°å‡¹çš„ï¼Œæ¯”å¦‚GMMä¸­çš„é«˜æ–¯åˆ†å¸ƒç­‰æŒ‡æ•°æ—åˆ†å¸ƒï¼‰ï¼Œå› æ­¤æ›´æ–°çš„æ–¹å¼ä¸º\n$$ \\tag{M step} \\theta^{new} = \\arg\\max_\\theta\\sum_{z\\in\\mathcal{Z}}p_{\\theta^{old}}(z|x)\\log p_\\theta(x, z) $$è¡¨ç¤ºæˆæ¦‚ç‡å›¾æ˜¯è¿™æ ·ï¼š\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://fingertap.github.io/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/cover.png'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_ce70c8f8535541a2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ‡¨ğŸ‡³</span></figure><div class=site-meta><h1 class=site-name><a href=/>å¼ æ™—çš„éšç¬”</a></h1><h2 class=site-description>çœ‹é£æ™¯ > çˆ¬ä¸Šå±±é¡¶</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about-me/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>About Me</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#emç®—æ³•>EMç®—æ³•</a></li><li><a href=#å˜åˆ†em>å˜åˆ†EM</a></li><li><a href=#vae>VAE</a><ol><li><a href=#monte-carlo-gradient-estimator>Monte Carlo gradient estimator</a></li><li><a href=#reparameterization-trick-sgvb-estimator>Reparameterization trick (SGVB estimator)</a></li><li><a href=#second-version-sgvb-estimator>Second Version SGVB estimator</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/><img src=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/cover_hu_4aceb241f2dfc9a4.png srcset="/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/cover_hu_4aceb241f2dfc9a4.png 800w, /p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/cover_hu_c22a5e1c2e92640c.png 1600w" width=800 height=800 loading=lazy alt="Featured image of post éšå˜é‡æ¨¡å‹æ€»ç»“"></a></div><div class=article-details><header class=article-category><a href=/categories/machine-learning/>Machine Learning</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/>éšå˜é‡æ¨¡å‹æ€»ç»“</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 01, 2019</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 2 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>æœ€å¤§ä¼¼ç„¶æ¡†æ¶ä¸‹ï¼Œå‡è®¾è§‚æµ‹å˜é‡æœ‰ç¼ºå¤±æˆ–ä¸å¯è§‚æµ‹çš„å±æ€§æ—¶ï¼Œè¦ç”¨åˆ°å˜åˆ†çš„æ–¹æ³•ã€‚éšå˜é‡æ¨¡å‹å¾€å¾€æ˜¯æ— ç›‘ç£æˆ–è€…å°‘ç›‘ç£æ¨¡å‹ï¼Œå› ä¸ºç›‘ç£ä¿¡æ¯å¯ä»¥çœ‹åšæ˜¯åŒ…å«åœ¨ç¼ºå¤±çš„éšå˜é‡ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</p><p>æ³¨æ„ï¼š</p><ol><li>ç¼ºå¤±è§‚æµ‹å’Œæ ·æœ¬ä¸€ä¸€å¯¹åº”ï¼Œè€Œå‚æ•°åˆ™æ˜¯æ‰€æœ‰æ ·æœ¬å…±äº«çš„ã€‚</li><li>ä¼¼ç„¶ä¸‹ç•Œçš„è¾“å…¥æ˜¯å‚æ•°å’Œå˜åˆ†åˆ†å¸ƒï¼Œæ¢¯åº¦å›å¸¦åˆ°å‚æ•°å’Œåˆ†å¸ƒä¸Šã€‚</li><li>ä¸å¯å¤„ç†ï¼ˆintractableï¼‰çš„åˆ†å¸ƒå®šä¹‰ä¸ºæ— æ³•è®¡ç®—ï¼Œä¸”æ— æ³•æ±‚å¯¼ã€‚</li></ol><p>å‡è®¾è¾“å…¥$(x, z)\in\mathcal{D}=\mathcal{X}\times\mathcal{Z}$ä¸­$\mathcal{Z}$ç©ºé—´æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±å˜ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°è¾¹ç¼˜ä¼¼ç„¶</p>$$
\tag{1}
\max_{\theta\in\Theta}\log\mathcal{L}(\theta;\mathbf{X})=\sum_{x\in\mathbf{X}}\log p_\theta(x)=\sum_{x\in\mathbf{X}}\log\sum_{z\in\mathcal{Z}}p_{\theta}(x, z),
$$<p>å…¶ä¸­$\mathbf{X}\subset\mathcal{X}$æ˜¯è§‚æµ‹åˆ°çš„æ•°æ®é›†ã€‚</p><h2 id=emç®—æ³•>EMç®—æ³•</h2><p>ç›´æ¥åœ¨å¼å­$(1)$ä¸­å¯¹$\theta$æ±‚å¯¼æ˜¯ä¸å¥½è®¡ç®—çš„ï¼Œå› ä¸º$\log$ä¸­æœ‰æ±‚å’Œã€‚EMç®—æ³•çš„æ€è·¯æ˜¯ä¼˜åŒ–$(1)$çš„ä¸‹ç•Œï¼Œ<strong>å…¶æ ¸å¿ƒå‡è®¾æ˜¯$p_\theta(x, z)$æ˜¯å¾ˆå¥½å¤„ç†çš„</strong>ã€‚åˆ©ç”¨$\log$å‡½æ•°çš„å‡¹æ€§å’ŒJensenä¸ç­‰å¼ï¼š</p>$$
\tag{2}
\log\sum_{z\in\mathcal{Z}}p_{\theta}(x, z) = \log\sum_{z\in\mathcal{Z}}\frac{p_{\theta}(x, z)}{q(z)}q(z) \geq \sum_{z\in\mathcal{Z}}q(z)\left\{\log p_\theta(x, z)-\log q(z)\right\},
$$<p>å…¶ä¸­$q(z)$æ˜¯ä»»æ„å®šä¹‰åœ¨$\mathcal{Z}$ä¸Šçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¸”$\forall z \in \mathcal{Z} q(z) > 0$ã€‚å› æ­¤ä¹‹åä¼˜åŒ–ä¸‹ç•Œ</p>$$
\max_\theta\hat{\mathcal{L}}(q, \theta;\mathbf{X})=\sum_{x\in\mathcal{X}}\sum_{z\in\mathcal{Z}}q(z)\left\{\log p_\theta(x, z)-\log q(z)\right\}.
$$<p>è¿™ä¸ªä¸‹ç•Œæ˜¯ä¸€ä¸ªåŒå˜é‡çš„æ³›å‡½ï¼Œä¸€ä¸ªå˜é‡æ˜¯æ¦‚ç‡å¯†åº¦$q$ï¼Œä¸€ä¸ªå˜é‡æ˜¯å‚æ•°$\theta$ã€‚é‡‡ç”¨åæ ‡æ¢¯åº¦æ³•ï¼Œäº¤æ›¿å¯»æ‰¾å½“å‰æœ€ä¼˜çš„$q$å’Œ$\theta$å³ä¸ºEMç®—æ³•ã€‚å¯¹$q$å–æœ€å¤§è¦æ±‚$(2)$å¼ä¸­ç­‰å·æˆç«‹ï¼Œå³è¦æ±‚$\forall z \in \mathcal{Z}, p_\theta(x, z)/q(z)=C$ï¼Œ$C$ä¸ºæŸä¸€å¸¸æ•°ï¼Œç®€å•è®¡ç®—ä¸€ä¸‹èƒ½å¾—åˆ°$C = p_\theta(x)$ï¼Œè€Œ</p>$$
\tag{E step}
q^\star(z)=p_{\theta}(z|x)
$$<p>è€Œæˆ‘ä»¬åœ¨Mæ­¥æ—¶å¾€å¾€ä¼šé‡åˆ°$\sum_zq(z)\cdot z$è¿™æ ·çš„$z$çš„æœŸæœ›å½¢å¼ï¼Œå› æ­¤åœ¨å®é™…å®ç°ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€åœ¨å†…å­˜é‡Œè®°å½•éšå˜é‡çš„æœŸæœ›</p>$$
\tag{E step in practice}
\mathbb{E}[z] = \sum_{z\in\mathcal{Z}}p_\theta(z|x)\cdot z
$$<p>è¿™ä¹Ÿæ˜¯Eæ­¥åå­—çš„ç”±æ¥ã€‚Mæ­¥å¾—ååŸå› æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸€æ­¥é‡Œå¯¹$\theta$æ±‚äº†æœ€å¤§ï¼Œæ³¨æ„è¿™ä¸ªä¸‹ç•Œå¾€å¾€æ˜¯å‡¹çš„ï¼ˆå¤§éƒ¨åˆ†æ¨¡å‹æ˜¯å¯¹æ•°å‡¹çš„ï¼Œæ¯”å¦‚GMMä¸­çš„é«˜æ–¯åˆ†å¸ƒç­‰æŒ‡æ•°æ—åˆ†å¸ƒï¼‰ï¼Œå› æ­¤æ›´æ–°çš„æ–¹å¼ä¸º</p>$$
\tag{M step}
\theta^{new} = \arg\max_\theta\sum_{z\in\mathcal{Z}}p_{\theta^{old}}(z|x)\log p_\theta(x, z)
$$<p>è¡¨ç¤ºæˆæ¦‚ç‡å›¾æ˜¯è¿™æ ·ï¼š</p><p><img src=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/EM_pgm.jpg width=1710 height=848 srcset="/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/EM_pgm_hu_37689ea88cea9b39.jpg 480w, /p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/EM_pgm_hu_3269574e2543dda0.jpg 1024w" loading=lazy alt="PGM for EM algorithm" class=gallery-image data-flex-grow=201 data-flex-basis=483px></p><h2 id=å˜åˆ†em>å˜åˆ†EM</h2><p>å˜åˆ†EMæ˜¯ä¸ºäº†å¤„ç†å…¨è´å¶æ–¯æƒ…å½¢ä¸‹å¯¹å‚æ•°ã€éšå˜é‡çš„å¤šé‡ç§¯åˆ†ä¸å¯æ±‚çš„é—®é¢˜è€Œå‘æ˜çš„ã€‚å˜åˆ†ï¼ˆvariationalï¼‰æ„å‘³ç€æˆ‘ä»¬è¦è¿‘ä¼¼ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ä¸€æ—å‡½æ•°ä¸­æ‰¾ä¸€ä¸ªæœ€èƒ½è¿‘ä¼¼ç›®æ ‡çš„ã€‚EMç®—æ³•ä¸­çš„$q(z)$å³ä¸ºä¸€ä¸ªå˜åˆ†åˆ†å¸ƒï¼Œç”¨ä»¥è¿‘ä¼¼çœŸå®çš„éšå˜é‡åéªŒåˆ†å¸ƒ$p_\theta(z|x)$ï¼Œè€Œå˜åˆ†EMç”šè‡³éœ€è¦å¯¹$q(z)$åšè¿›ä¸€æ­¥çš„è¿‘ä¼¼ã€‚</p><p>EMç®—æ³•å‡è®¾æˆ‘ä»¬æœ‰å‚æ•°$\theta$å’Œéšå˜é‡$z$è¦ä¼°è®¡ã€‚ç‰¹åˆ«åœ°ï¼Œå¯¹äºå‚æ•°$\theta$æˆ‘ä»¬åšçš„æ˜¯ç‚¹ä¼°è®¡ï¼Œæ˜¯æœ€å¤§ä¼¼ç„¶æˆ–è€…æœ€å¤§åéªŒæ¨æ–­ã€‚ä½†æ˜¯åœ¨å…¨è´å¶æ–¯æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯¹$\theta$ä¹Ÿä¼šå¼•å…¥å…ˆéªŒåˆ†å¸ƒ$p(\theta|\alpha)$ï¼Œå¹¶ç§¯åˆ†æ‰$\theta$ï¼ˆ$\alpha$æ˜¯è¶…å‚ï¼‰ã€‚ä¹Ÿå³ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ˜¯</p>$$
\max_\alpha \int p(x|\theta)p(\theta|\alpha) d\theta=\int\int p(x, z|\theta)p(\theta|\alpha)d\theta dz
$$<p>æˆ‘ä»¬å¯ä»¥æŠŠ$\theta$å¸æ”¶åˆ°$z$ä¸­ï¼Œå½¢å¼ä¸Šå…¶å®å’Œ$(2)$ä¸€è‡´ã€‚å³ä¾¿æˆ‘ä»¬ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q(z, \theta)$æ¥è¿‘ä¼¼$p_\alpha(z, \theta|x)$ï¼Œåœ¨EMç®—æ³•ä¸­å¾€å¾€ä¹Ÿä¼šæ¶‰åŠåˆ°intractableçš„ç§¯åˆ†ã€‚ä¸€ä¸ªæ€è·¯æ˜¯é‡‡æ ·è¿™æ ·çš„ç§¯åˆ†ï¼Œç”¨MCMCæ–¹æ³•çš„æ€è·¯ï¼Œè¿™æ ·åšçš„ç¼ºç‚¹æ˜¯å¯¹æ¯ä¸ªæ ·æœ¬éƒ½è¦åšä¸€æ¬¡é‡‡æ ·ï¼Œå¯¹äºå¤§æ•°æ®é›†è®¡ç®—å¼€é”€ç›¸å½“å¤§ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯è§£è€¦åˆè¿™æ ·å¯ä»¥åˆ†ç»„çš„éšå˜é‡ã€‚</p><p>æˆ‘ä»¬å‡è®¾$q(z, \theta) = q(z)q(\theta)$ï¼Œæˆ–è€…æ›´ä¸€èˆ¬åœ°ï¼Œå‡è®¾$q(z) = \prod_i q_i(z_i)$ï¼Œå³æ¯ç»„éšå˜é‡æœ‰è‡ªå·±çš„å˜åˆ†åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ã€‚å‡è®¾è¿™æ ·åˆ†è§£ä»¥åï¼Œå¯¹äºæ¯ä¸ªéšå˜é‡ç»„$q_i(z_i)$éƒ½æ˜¯tractableçš„ï¼Œè®°$q_i=q_i(z_i)$ï¼Œå•ç‹¬æå–å‡º$z_j$è§‚å¯Ÿä¸‹ç•Œ$\hat{\mathcal{L}}$æœ‰</p>$$
\begin{align}
\hat{\mathcal{L}(q)} &= \int \prod_i q_i \left\{\log p(x, z)-\sum_i\log q_i\right\}dz \\
&=\int \prod_i q_i\log p(x, z)dz-\int\prod_iq_i\sum_{i'}\log q_{i'} dz \\
&=\int q_j\left\{\int\log p(x, z)\prod_{i\neq j}q_i dz_i \right\}dz_j - \int \prod_{i} q_i\log q_jdz + \int \prod_i q_i\sum_{i'\neq j}\log q_{i'} dz\\
&= \int q_j \mathbb{E}_{i\neq j}[\log p(x, z)]dz_j - \int q_j\log q_jdz_j + const
\end{align}
$$<p>æŠŠå³ä¾§çœ‹åšä¸€ä¸ªKLæ•£åº¦ï¼Œæœ€ä¼˜çš„$q_j$æ»¡è¶³</p>$$
\tag{Variational EM}
\log q_j^\star(z_j) = \mathbb{E}_{i\neq j}[\log p(x, z)]
$$<p>æ³¨æ„åˆ°æ›´æ–°$z_j$çš„åˆ†å¸ƒéœ€è¦ç”¨åˆ°$i\neq j$çš„æ‰€æœ‰åˆ†å¸ƒæ¥ç®—$p(x, z)$ï¼Œå› æ­¤ä¸åŒçš„éšå˜é‡ç»„çš„æ›´æ–°æ˜¯ç›¸äº’ä¾èµ–çš„ã€‚å˜åˆ†EMè¿­ä»£åœ°å›ºå®š$i\neq j$æ¥æ›´æ–°æŸä¸ªéšå˜é‡$z_j$ï¼Œç›´è‡³æ‰€æœ‰çš„éšå˜é‡ç»„åˆ†å¸ƒæ”¶æ•›ã€‚æ¦‚ç‡å›¾å¦‚ä¸‹ï¼š</p><p><img src=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/variational_EM_pgm.jpg width=1236 height=936 srcset="/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/variational_EM_pgm_hu_8a48df77f773ec61.jpg 480w, /p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/variational_EM_pgm_hu_cc478040d61e440e.jpg 1024w" loading=lazy alt="PGM for variational EM" class=gallery-image data-flex-grow=132 data-flex-basis=316px></p><h2 id=vae>VAE</h2><p>å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Auto Encoderï¼‰ä¹Ÿæ˜¯éšå˜é‡çš„intractabilityå¸¦æ¥çš„ï¼Œä¸åŒä¹‹å¤„æ˜¯VAEè¿›ä¸€æ­¥å‡è®¾ï¼Œ$p_\theta(x, z), p_{\theta}(z|x)$éƒ½æ˜¯intractableçš„ï¼Œä¸”å˜åˆ†å°†$z$åˆ†ç»„ä¹Ÿä¸èƒ½ä½¿å¾—åˆ†å¸ƒå˜ä¸ºtractableçš„ï¼Œè¿™æ ·çš„æƒ…å½¢æ˜¯å­˜åœ¨çš„ï¼Œæ¯”å¦‚éçº¿æ€§ç¥ç»ç½‘ç»œã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ›´å¥½çš„å˜åˆ†æ–¹å¼æ¥è¿‘ä¼¼$p_\theta(z|x)$ã€‚VAEæå‡ºçš„æ–¹æ¡ˆæ˜¯ç”¨ä¸€ä¸ªç”±$\phi$æ§åˆ¶çš„åˆ†å¸ƒ$q_\phi(z|x)$ï¼š</p>$$
\begin{align}
\tag{3}
\hat{\mathcal{L}} (\theta, \phi; \mathbf{X}) &= \sum_{x\in\mathcal{X}}\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x, z)-\log q_\phi(z|x)]\\
&= \sum_{x\in\mathcal{X}}\sum_{z\in\mathcal{Z}}q_\phi(z|x)\left\{\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)\right\} \\
\tag{5}
& = \sum_{x\in\mathcal{X}}\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)] - \text{KL}\left[q_\phi(z|x)\Vert p_\theta(z)\right]
\end{align}
$$<p>å…¶ä¸­$q_\phi(z|x)$è¢«ç†è§£ä¸ºç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼Œå°†è§‚æµ‹æ ·æœ¬æ˜ å°„åˆ°éšå˜é‡ç©ºé—´$\mathcal{Z}$ï¼Œ$p_\theta(x|z)$ä¸ºè§£ç å™¨ï¼Œå°†éšå˜é‡æ˜ å°„å›è§‚æµ‹æ ·æœ¬ç©ºé—´$\mathcal{X}$ã€‚</p><p>æˆ‘ä»¬è¦ä¼˜åŒ–$\hat{\mathcal{L}}$éœ€è¦å¯¹$\theta$å’Œ$\phi$æ±‚å¯¼ï¼Œå…¶ä¸­å¯¹$\phi$æ±‚å¯¼å› ä¸ºæœŸæœ›çš„å­˜åœ¨æœ‰å‡ ç§å¤„ç†æ–¹å¼ã€‚è¿™é‡Œçœ‹åˆ°$\hat{\mathcal{L}}$æœ‰$(3)$å’Œ$(5)$ä¸¤ç§è¡¨ç¤ºï¼Œå…¶å¯¹$\phi$æ±‚å¯¼æœ‰äº›é—®é¢˜ã€‚</p><h3 id=monte-carlo-gradient-estimator>Monte Carlo gradient estimator</h3><p>ä¸€èˆ¬æœŸæœ›å¯¹äºåˆ†å¸ƒçš„å‚æ•°æ±‚å¯¼å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¿‘ä¼¼</p>$$
\begin{align}
\nabla_\phi\mathbb{E}_{q_\phi(z)}[f(z)] &= \int f(z) \nabla_\phi q_\phi(z) dz \\
&=\int f(z) q_\phi(z) \frac{\nabla_\phi q_\phi(z)}{q_\phi(z)} dz\\
&=\int f(z)q_\phi(z)\nabla_\phi\log q_\phi(z) dz\\
&=\mathbb{E}_{q_\phi(z)}[f(z)\nabla_\phi\log q_\phi(z)] \\
&\simeq \frac{1}{L}\sum_{l=1}^{L}f(z^{(l)})\nabla_\phi\log q_\phi(z^{(l)})
\end{align}
$$<p>ä½†æ˜¯è¿™æ ·å¾—åˆ°çš„è¿‘ä¼¼æ–¹å·®å¾ˆå¤§ï¼Œéœ€è¦è¾ƒå¤§çš„$L$æ¥ä¿è¯ä¸€ä¸ªå¾ˆå¥½çš„æ¢¯åº¦ä¼°è®¡ï¼ˆè¯¦è§<a class=link href=https://icml.cc/2012/papers/687.pdf target=_blank rel=noopener>è¿™ç¯‡æ–‡ç« </a>ï¼‰ã€‚åœ¨$(3)$ä¸­æˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹å¼å¾—åˆ°$\hat{\mathcal{L}}$å¯¹$\phi$çš„å¯¼æ•°ï¼Œä½†æ˜¯è¾ƒå¤§çš„$L$ä½¿å¾—æ¯ä¸ªæ ·æœ¬çš„é‡‡æ ·ä»£ä»·é«˜ï¼Œå› æ­¤åœ¨å¤§æ•°æ®é›†ä¸Šæ²¡æœ‰åŠæ³•åº”ç”¨ã€‚</p><h3 id=reparameterization-trick-sgvb-estimator>Reparameterization trick (SGVB estimator)</h3><p>å¯¹äºå¼$(3)$ä¸­çš„æœŸæœ›ï¼Œå¦‚æœæˆ‘ä»¬å¯¹$z$èŠ‚ç‚¹è¿›è¡Œé‡‡æ ·è¿‘ä¼¼ä»¥åï¼Œå†ç®—å¯¹$\phi$çš„å¯¼æ•°ä¼šå¾—åˆ°ä¸æ­£ç¡®çš„ç»“æœï¼Œå› ä¸ºé‡‡æ ·çš„åˆ†å¸ƒ$q_\phi(z|x)$æ˜¯ä¾èµ–$\phi$çš„ï¼Œæ¦‚ç‡å›¾å¦‚ä¸‹ï¼š</p><p><img src=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/VAE_pgm.jpg width=822 height=758 srcset="/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/VAE_pgm_hu_b4aad4d3cb62f3d9.jpg 480w, /p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/VAE_pgm_hu_cbcbfa9fad28bed6.jpg 1024w" loading=lazy alt="PGM for VAE" class=gallery-image data-flex-grow=108 data-flex-basis=260px></p><p>Reparameterizationå°†éšæœºæ€§çš„æ¥æºä»$z$è½¬ç§»åˆ°å¦ä¸€ä¸ªè¾…åŠ©çš„å™ªå£°å˜é‡$\epsilon$ï¼Œå‡è®¾$z=g_\phi(\epsilon, x)$ï¼Œå…¶ä¸­$\epsilon\sim p(\epsilon)$ï¼Œ$(3)$å¼å˜ä¸º</p>$$
\begin{align}
\hat{\mathcal{L}}{}^A(\phi, \theta;\mathbf{X}) &= \sum_{x\in\mathcal{X}}\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x, z)-\log q_\phi(z|x)] \\
&=\sum_{x\in\mathcal{X}}\mathbb{E}_{p(\epsilon)}[\log p_\theta(x, g_\phi(\epsilon, x))-\log q_\phi(g_\phi(\epsilon, x)|x)]\\
&\simeq \sum_{x\in\mathcal{X}}\frac{1}{L}\log p_\theta(x, g_\phi(\epsilon^{(l)}, x))-\log q_\phi(g_\phi(\epsilon^{(l)}, x)|x)
\end{align}
$$<p>è¿™æ ·çš„è¿‘ä¼¼æ¯”MCæ¢¯åº¦è¿‘ä¼¼æœ‰æ›´å°çš„æ–¹å·®ï¼Œä¸”æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹æŸå¤±å‡½æ•°è¿›è¡Œè¿‘ä¼¼ã€‚SGVBçš„æ¦‚ç‡å›¾å¦‚ä¸‹ï¼š</p><p><img src=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/SGVB_pgm.jpg width=612 height=796 srcset="/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/SGVB_pgm_hu_79e5feb37141ef71.jpg 480w, /p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/SGVB_pgm_hu_dce0890904a768cd.jpg 1024w" loading=lazy alt="PGM for SGVB" class=gallery-image data-flex-grow=76 data-flex-basis=184px></p><h3 id=second-version-sgvb-estimator>Second Version SGVB estimator</h3><p>$(3)$å¼å¯ä»¥åŒ–ç®€ä¸º$(5)$å¼ï¼Œè‹¥$(5)$å¼ä¸­çš„KLæ•£åº¦é¡¹å¯ä»¥ç§¯åˆ†ï¼ˆtractableï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥åªå¯¹$(5)$å¼ä¸­çš„ç¬¬ä¸€é¡¹è¿›è¡Œé‡‡æ ·è¿‘ä¼¼ï¼Œç›¸æ¯”äºæœ€åŸå§‹çš„SGVBä¼°è®¡å­ï¼Œå› ä¸ºåªå¯¹å˜åˆ†ä¸‹ç•Œ$\hat{\mathcal{L}}$çš„ä¸€éƒ¨åˆ†è¿‘ä¼¼ï¼Œæ–¹å·®ä¼šæ›´å°ï¼š</p>$$
\hat{\mathcal{L}}{}^B(\phi, \theta; \mathbf{X}) = -\text{KL}\left[q_\phi(z|x)\Vert p_\theta(z)\right] + \frac{1}{L}\sum_{l=1}^L\log p_\theta\left(x\middle|g_\phi(\epsilon^{(l)}, x)\right)
$$<p>æœ€åï¼Œæ•´ä¸ªVAEçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p><img src=/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/VAE_flowchart.jpg width=1699 height=420 srcset="/p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/VAE_flowchart_hu_d2c23aa8928313f1.jpg 480w, /p/%E9%9A%90%E5%8F%98%E9%87%8F%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/VAE_flowchart_hu_2bd7d9fa74e02e8f.jpg 1024w" loading=lazy alt="VAE flowchart" class=gallery-image data-flex-grow=404 data-flex-basis=970px></p></section><footer class=article-footer><section class=article-tags><a href=/tags/machine-learning/>Machine Learning</a>
<a href=/tags/bayesian/>Bayesian</a>
<a href=/tags/math/>Math</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84kl%E6%95%A3%E5%BA%A6%E4%BC%B0%E8%AE%A1/><div class=article-image><img src=/p/%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84kl%E6%95%A3%E5%BA%A6%E4%BC%B0%E8%AE%A1/cover.b4fff78720d50821465ba154fdc2df26_hu_3b4a1b04b09dd2a6.png width=250 height=150 loading=lazy alt="Featured image of post ä¸€ç§æ–°çš„KLæ•£åº¦ä¼°è®¡" data-hash="md5-tP/3hyDVCCFGW6FU/cLfJg=="></div><div class=article-details><h2 class=article-title>ä¸€ç§æ–°çš„KLæ•£åº¦ä¼°è®¡</h2></div></a></article><article class=has-image><a href=/p/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%94%B6%E6%95%9B%E5%88%86%E6%9E%90/><div class=article-image><img src=/p/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%94%B6%E6%95%9B%E5%88%86%E6%9E%90/cover.0f792aeaf735d1882c7842d7f7a09182_hu_934424ce9ce33e5a.png width=250 height=150 loading=lazy alt="Featured image of post æ¢¯åº¦ä¸‹é™æ”¶æ•›åˆ†æ" data-hash="md5-D3kq6vc10YgseELX96CRgg=="></div><div class=article-details><h2 class=article-title>æ¢¯åº¦ä¸‹é™æ”¶æ•›åˆ†æ</h2></div></a></article><article class=has-image><a href=/p/%E4%BB%8E%E6%8B%92%E7%BB%9D%E9%87%87%E6%A0%B7%E5%88%B0%E6%8A%95%E6%9C%BA%E6%8E%A8%E7%90%86/><div class=article-image><img src=/p/%E4%BB%8E%E6%8B%92%E7%BB%9D%E9%87%87%E6%A0%B7%E5%88%B0%E6%8A%95%E6%9C%BA%E6%8E%A8%E7%90%86/cover.84d3b9acd81cdce809bf40d9c86bf4b0_hu_2ec8dbcdde98afbe.png width=250 height=150 loading=lazy alt="Featured image of post ä»æ‹’ç»é‡‡æ ·åˆ°æŠ•æœºæ¨ç†" data-hash="md5-hNO5rNgc3OgJv0DZyGv0sA=="></div><div class=article-details><h2 class=article-title>ä»æ‹’ç»é‡‡æ ·åˆ°æŠ•æœºæ¨ç†</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 å¼ æ™—çš„éšç¬”</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>